<<!DOCTYPE html>
<html lang="en">
<head>
    <title>Hover Truck</title>
    <meta charset="utf-8">
    <link rel="shortcut icon" type="image/x-icon" href="../../img/favicon.ico">
    <link rel="stylesheet" href="styles.css">
    <script src="https://aframe.io/releases/0.9.2/aframe.min.js"></script>

    <!--camera orbit script from https://github.com/supermedium/superframe/tree/master/components/orbit-controls-->
    <script src="https://unpkg.com/aframe-orbit-controls@1.2.0/dist/aframe-orbit-controls.min.js"></script>

    <!--GIF shader script from https://github.com/mayognaise/aframe-gif-shader-->
    <script src="https://rawgit.com/mayognaise/aframe-gif-shader/master/dist/aframe-gif-shader.min.js"></script>

    <script defer>
        document.querySelector('completeModel').addEventListener('animationcomplete')
    </script>
</head>
<body>
    <a-scene vr-mode-ui="enabled: false">
        <a-assets>
            <!--All models and textures by Landon Tubesing, made in Blender 2.80. HDRI image from https://hdrihaven.com/-->
            <img id="gif-front" src="assets/texture/front.gif"/>
            <img id="gif-back" src="assets/texture/back.gif"/>

            <img id="hdri" src="assets/texture/studio_small_01_8k.jpg"/>
            <img id="ref-map" src="assets/texture/ref_map.jpg"/>

            <img id="body-diff" src="assets/texture/truck_diff.png"/>
            <img id="body-rough" src="assets/texture/truck_rough.png"/>

            <img id="equipment-diff" src="assets/texture/equipment_diff.png"/>
            <img id="equipment-rough" src="assets/texture/equipment_rough.png"/>

            <img id="movement-diff" src="assets/texture/movement_diff.png"/>
            <img id="movement-rough" src="assets/texture/movement_rough.png"/>

            <img id="rear-diff" src="assets/texture/rear_diff.png"/>
            <img id="rear-rough" src="assets/texture/rear_rough.png"/>

            <img id="struts-diff" src="assets/texture/things_diff.png"/>
            <img id="struts-rough" src="assets/texture/things_rough.png"/>

            <a-asset-item id="body" src="assets/model/body.obj"></a-asset-item>
            <a-asset-item id="struts" src="assets/model/struts.obj"></a-asset-item>
            <a-asset-item id="movement" src="assets/model/movement.obj"></a-asset-item>
            <a-asset-item id="rear" src="assets/model/rear.obj"></a-asset-item>
            <a-asset-item id="equipment" src="assets/model/equipment.obj"></a-asset-item>
            <a-asset-item id="thrust-front" src="assets/model/thrust_front.obj"></a-asset-item>
            <a-asset-item id="thrust-back" src="assets/model/thrust_back.obj"></a-asset-item>

            <a-mixin id="gen-item" scale="0.2 0.2 0.2"></a-mixin>
        </a-assets>

        <a-entity id="camera-rig" position="0 0 -0.26" animation="property: rotation; to: 0 360 0; dur: 15000; easing: linear; loop: true;">
            <a-camera
                look-controls
                position="0 0 0"
                orbit-controls="enablePan: false; enableZoom: false; target: 0 0 -0.26; initialPosition: 0 0.6 2.5;"
                wasd-controls="enabled: false">
            </a-camera>
        </a-entity>

        <a-sky src="#hdri" geometry=""></a-sky>
        <a-entity position="-0.96 0.694 -2.224" light="color: #e4e8e9; intensity: 0.44"></a-entity>
        <a-entity position="-1.61 1.875 1.100" light="intensity: 0.7"></a-entity>
        <a-entity position="0 0.545 -0.619" light="color: #000000; groundColor: #abc0cb; intensity: 0.4; type: hemisphere"></a-entity>
        <a-entity position="1.469 0.304 2.110" light="color: #becdcd; type: point"></a-entity>
        <a-entity position="0 3.063 -5.533" light="color: #aecab3; groundColor: #000000; intensity: 0.23; shadowBias: 0.74; shadowRadius: 2.75"></a-entity>

        <a-entity
            id="completeModel"
            mixin="gen-item"
            animation="property: position; dur: 700; from: 0 -0.07 0; to: 0 0.07 0; dir: alternate; easing: easeInOutSine; loop: true;"
            animation__roll="property: rotation; dur: 1400; from: 0 0 -4; to: 0 0 4; dir: alternate; easing: easeInOutSine; loop: true;"
            animation__pitch="property: rotation; dur: 2800; from -10 0 0; to: 10 0 0; dir: alternate; easing: easeInOutSine; loop:true;">

            <a-entity material="roughnessMap: #body-rough; src: #body-diff; sphericalEnvMap: #ref-map; envMapIntensity: 1.0" obj-model="obj: #body">
            </a-entity>

            <a-entity material="roughnessMap: #struts-rough; src: #struts-diff; metalness: 1; sphericalEnvMap: #ref-map; envMapIntensity: 1.0" obj-model="obj: #struts">
            </a-entity>

            <a-entity material="roughnessMap: #movement-rough; src: #movement-diff; metalness: 1; sphericalEnvMap: #ref-map; envMapIntensity: 1.0" obj-model="obj: #movement">
            </a-entity>

            <a-entity material="roughnessMap: #rear-rough; src: #rear-diff; metalness: 1.0; sphericalEnvMap: #ref-map; envMapIntensity: 1.0" obj-model="obj: #rear">
            </a-entity>

            <a-entity material="roughnessMap: #equipment-rough; src: #equipment-diff; metalness: 1.0; sphericalEnvMap: #ref-map; envMapIntensity: 1.0" obj-model="obj: #equipment">
            </a-entity>

            <a-entity id="flame">
                <a-entity material="shader: gif; src: #gif-front; blending: additive" obj-model="obj: #thrust-front">
                </a-entity>

                <a-entity material="shader: gif; src: #gif-back; blending: additive" obj-model="obj: #thrust-back">
                </a-entity>
            </a-entity>
        </a-entity>
    </a-scene>
    <div id="ToggleButton">
        <button onclick="toggleThrust()">Toggle Thrusters</button>
    </div>
</body>
</html>
